{% extends "myapp/base.html" %} {% block content %}

<script>
	window.addEventListener('beforeunload', function () {
		var confirmationMessage =
			'Êtes-vous sûr de vouloir quitter cette page ?';

		// Certains navigateurs nécessitent un retour pour afficher le message
		e.returnValue = confirmationMessage;
		// Effectuer une requête AJAX pour informer le serveur que l'utilisateur quitte la salle
		var xhr = new XMLHttpRequest();
		xhr.open('POST', '/leave/{{ room_id }}', true); // Remplacez '/leave-room/' par l'URL appropriée
		xhr.setRequestHeader('X-CSRFToken', '{{ csrf_token }}');
		xhr.send();
	});
</script>

<div class="room-content">
	<ul>
		{% for username in usernames %}
		<li>{{ username }}</li>
		{% endfor %}
	</ul>
</div>
<form action="/leave/{{ room_id }}/" method="post">
	{% csrf_token %}
	<h2>Code : {{ room_id }}</h2>
	<button type="submit">Leave the room</button>
</form>
{% endblock content %}
